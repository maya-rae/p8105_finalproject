---
title: "Operator Analysis"
output: html_document
date: "2025-11-21"
---

```{r}
library(dplyr)
library(knitr)
```

Reading in the dataset here:
```{r}
df_airplane = read.csv("/Users/karolinawiesiolek/Desktop/Data_Science/FinalProject/datasets/airplane_crashes.csv")
```

## This code counts how many times each airline operator appears in the dataset (how many crashes are associated with each operator) and sorts them from most frequent to least frequent.
```{r}
operator_counts = df_airplane |> ## This code checks for all the operators listed in the df and counts them up 
  count(Operator, sort = TRUE) ## This lines sorts the operators 
```

## These lines count how many crashes are associated with each operator, filter the operators appearing more than five times, and extract the operator with the highest crash frequency.
```{r}
operator_counts = df_airplane |>
count(Operator, sort = TRUE)

operator_counts_filtered = operator_counts |>
filter(n > 5)

top_operator = operator_counts |>
slice(1)

```

## The first chunk prints a formatted table of operators with more than five crashes.
The second chunk extracts the most frequent operator and prints a sentence describing which operator appears most often and how many crashes are associated with it.

```{r}
kable(operator_counts_filtered,
caption = "Operators Appearing More Than 5 Times")


top_operator_name = top_operator$Operator
top_operator_count = top_operator$n

paste(
"The operator that appears most often is",
top_operator_name,
"with",
top_operator_count,
"occurrences."
)

```


## The plot shows a dramatic visual difference: Aeroflot experienced over 200 crashes, far exceeding all other operators. Even compared to operators with more than 20 crashes, Aeroflotâ€™s crash count stands out as exceptionally high.

```{r}
library(ggplot2)

operator_counts_filtered_20 = operator_counts |>
  filter(n > 20)

operator_counts_filtered_20 |>
  ggplot(aes(x = reorder(Operator, n), y = n)) +
  geom_col() +
  coord_flip() +
  labs(
    title = "Frequency of Operators (More Than 20 Appearances)",
    x = "Operator",
    y = "Count"
  )

```
